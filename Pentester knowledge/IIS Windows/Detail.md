<h1>Quick Checklist for IIS Windows Pentesting</h1>

1.**Internal IP Information disclosure:** Try removing a **host header** and use **HTTP 1.0** to perform the test. This happens due to the it couldn't find the host to route to so i use a default configuration which is why it leaks out the internal IP address.

2.**Webshell via web.config:** If you spot file upload function, try uploading .config which is like **.htaccess** in apache server. Use the following URL;

web.config webshell - [HERE](https://github.com/yamerooo123/ResearchNBugBountyEncyclopedia/blob/main/Custom%20tools/Inventory/IIS%2010.0/web.config)

3.**Directory Fuzzing:** To find IIS default folders, use the below tool.

[IIS Shortname scanner](https://github.com/irsdl/IIS-ShortName-Scanner) 
```
java -jar iis_shortname_scanner.jar [URL]
```
**Additional wordlist:** [HERE](https://github.com/yamerooo123/ResearchNBugBountyEncyclopedia/blob/main/Custom%20tools/Inventory/IIS%2010.0/iisfinal.txt)

4.**General Information Disclosure(Server Banner Exposeure):** Usually found in the HTTP response.

![image](https://github.com/user-attachments/assets/053bfafa-be4e-47a6-a360-e1e22c71cfe8)

5.**Lack of Security Headers:** Usually one or more of the following HTTP response headers are missing

```
X-Frame-Options
Cache-Control
X-XSS-Protection
Strict-Transport-Security
X-Content-Type-Options
Content-Security-Policy
Referrer-Policy
Public-Key-Pins
Permissions-Policy
X-Content-Security-Policy
```

References
---
https://medium.com/@far00t01/asp-net-microsoft-iis-pentesting-04571fb071a4

https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/iis-internet-information-services

https://soroush.me/blog/2014/07/upload-a-web-config-file-for-fun-profit/
