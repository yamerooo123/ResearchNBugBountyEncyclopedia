# For tracking all my CVE status. 
# Suphawith Phusanbai
# Usage "python3 counter.py" or "python3 counter.py > results.txt"
import requests
from tabulate import tabulate

# Update this list. 
checklist = [
    'CVE-2024-48093', 'CVE-2024-48827', 'CVE-2024-50634',
    'CVE-2024-50636', 'CVE-2024-50637', 'CVE-2024-52305',
    'CVE-2024-53484', 'CVE-2024-57276', 'CVE-2024-57277'
]

results = []

for cve in checklist:
    make_connection = requests.get(f'https://cveawg.mitre.org/api/cve/{cve}')

    if make_connection.status_code == 200:
        if "disputed" in make_connection.text:
            results.append([cve, "Disputed"])
        else:
            results.append([cve, "Cool"])
    else:
        results.append([cve, "Error"])

table = tabulate(results, headers=["CVE ID", "Status"], tablefmt="pretty")
print(table)
